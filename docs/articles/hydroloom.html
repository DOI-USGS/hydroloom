<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="hydroloom">
<title>Hydroloom Overview • hydroloom</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Hydroloom Overview">
<meta property="og:description" content="hydroloom">
<meta property="og:image" content="https://doi-usgs.github.io/hydroloom/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hydroloom</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/hydroloom.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/advanced_network.html">Topological Sort Based Network Attributes</a>
    <a class="dropdown-item" href="../articles/flow-table.html">NHD Flow Table with Hydroloom</a>
    <a class="dropdown-item" href="../articles/non-dendritic.html">Non-dendritic networks</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DOI-USGS/hydroloom/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Hydroloom Overview</h1>
                        <h4 data-toc-skip class="author"><a href="mailto:dblodgett@usgs.gov" class="email">dblodgett@usgs.gov</a></h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DOI-USGS/hydroloom/blob/HEAD/vignettes/hydroloom.Rmd" class="external-link"><code>vignettes/hydroloom.Rmd</code></a></small>
      <div class="d-none name"><code>hydroloom.Rmd</code></div>
    </div>

    
    
<style type="text/css">
   .main-container {max-width: 100%;}
   .row {display: flex;}
   .column {flex: 50%;}
</style>
<div class="section level2">
<h2 id="hydroloom">hydroloom<a class="anchor" aria-label="anchor" href="#hydroloom"></a>
</h2>
<p>Hydroloom is designed to provide general hydrologic network
functionality for any hydrographic or hydrologic data. This is
accomplished with<br>
1) the <code>hy</code> S3 class,<br>
2) a collection of utility functions,<br>
3) functions to work with a hydrologic network topology as a
graph,<br>
4) functions to create and add useful network attributes,<br>
5) and functions to index data to a network of flow network lines and
waterbody polygons.</p>
<p>This introduction covers the <code>hy</code> S3 class and the core
flow network topology concepts necessary to use hydroloom
effectively.</p>
<p>For the latest development and to open issues, please visit the <a href="https://github.com/DOI-USGS/hydroloom" class="external-link">package github
repository.</a></p>
</div>
<div class="section level2">
<h2 id="hy-s3-class">
<code>hy</code> S3 class<a class="anchor" aria-label="anchor" href="#hy-s3-class"></a>
</h2>
<p>Hydroloom implements an <code>hy</code> S3 class designed to simplify
integration of <code>hydroloom</code> with existing data and workflows.
<code><a href="../reference/hy.html">hy()</a></code> converts a data.frame to an <code>hy</code>
<code>data.frame</code> with attributes compatible with
<code>hydroloom</code> functions. <code><a href="../reference/hy_reverse.html">hy_reverse()</a></code> converts a
<code>hy</code> <code>data.frame</code> back to its original attribute
names. You can teach <code>hydroloom</code> how to map your attributes
to <code><a href="../reference/hydroloom_name_definitions.html">hydroloom_name_definitions()</a></code> with the
<code><a href="../reference/hydroloom_names.html">hydroloom_names()</a></code> function.8</p>
<p>Most <code>hydroloom</code> functions will work with either a
<code>hy</code> object or a <code>data.frame</code> containing names
registered with <code><a href="../reference/hydroloom_names.html">hydroloom_names()</a></code>. Any attributes added to
the <code>data.frame</code> will contain names from
<code>hydroloom</code> and must be renamed in the calling
environment.</p>
<p>Internally, the <code>hy</code> S3 class has an attribute
<code>orig_names</code> as shown below. The <code>orig_names</code>
attribute is used to convert original attribute names back to their
original values. Using the <code>hydroloom</code> names and the
<code>hy</code> S3 object are note required but adopting
<code>hydroloom_names_definitions()</code> may be helpful for people
aiming for consistent, simple, and accurate attribute names.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DOI-USGS/hydroloom" class="external-link">hydroloom</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">hy_net</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/new_hope.gpkg"</span>, package <span class="op">=</span> <span class="st">"hydroloom"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">COMID</span>, <span class="va">REACHCODE</span>, <span class="va">FromNode</span>, <span class="va">ToNode</span>, <span class="va">Hydroseq</span>, <span class="va">TerminalFl</span>, <span class="va">Divergence</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/hy.html">hy</a></span><span class="op">(</span><span class="va">hy_net</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 3 features and 7 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTILINESTRING</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 1517192 ymin: 1555954 xmax: 1518702 ymax: 1557298</span></span>
<span><span class="co">#&gt; CRS:           unknown</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 8</span></span></span>
<span><span class="co">#&gt;        id aggregate_id    fromnode    tonode topo_sort terminal_flag divergence</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 8<span style="text-decoration: underline;">893</span>864 03030002000018 250<span style="text-decoration: underline;">031</span>721 250<span style="text-decoration: underline;">031</span>853 250<span style="text-decoration: underline;">016</span>373             0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 8<span style="text-decoration: underline;">894</span>490 03030002000018 250<span style="text-decoration: underline;">031</span>895 250<span style="text-decoration: underline;">031</span>854 250<span style="text-decoration: underline;">015</span>665             0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 8<span style="text-decoration: underline;">894</span>494 03030002000018 250<span style="text-decoration: underline;">031</span>897 250<span style="text-decoration: underline;">031</span>895 250<span style="text-decoration: underline;">015</span>826             0          0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: geom &lt;MULTILINESTRING [m]&gt;</span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="../reference/hy.html">hy</a></span><span class="op">(</span><span class="va">hy_net</span><span class="op">)</span>, <span class="st">"orig_names"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           COMID       REACHCODE        FromNode          ToNode        Hydroseq </span></span>
<span><span class="co">#&gt;            "id"  "aggregate_id"      "fromnode"        "tonode"     "topo_sort" </span></span>
<span><span class="co">#&gt;      TerminalFl      Divergence            geom </span></span>
<span><span class="co">#&gt; "terminal_flag"    "divergence"          "geom"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="network-representation">Network Representation<a class="anchor" aria-label="anchor" href="#network-representation"></a>
</h2>
<div class="section level3">
<h3 id="representing-dendritic-network-topology">Representing Dendritic Network Topology<a class="anchor" aria-label="anchor" href="#representing-dendritic-network-topology"></a>
</h3>
<p>A network of flowlines can be represented as an edge-to-edge
(e.g. edge list) or edge-node topology. An edge list only expresses the
connectivity between <em>edges</em> (flowlines in the context of
rivers), requiring <em>nodes</em> (confluences in the context of rivers)
to be inferred.</p>
<pre><code><span><span class="co">#&gt;  id toid fromnode tonode</span></span>
<span><span class="co">#&gt;   1    3       N1     N3</span></span>
<span><span class="co">#&gt;   2    3       N2     N3</span></span>
<span><span class="co">#&gt;   3   NA       N3     N4</span></span></code></pre>
<div class="figure" style="text-align: center">
<img src="hydroloom_files/figure-html/node-1.png" alt="In an edge-node topology, edges are directed to nodes which are then directed to other edges. An edge-to-edge toplogy does not include intervening nodes." width="45%"><img src="hydroloom_files/figure-html/node-2.png" alt="In an edge-node topology, edges are directed to nodes which are then directed to other edges. An edge-to-edge toplogy does not include intervening nodes." width="45%"><p class="caption">
In an edge-node topology, edges are directed to nodes which are then
directed to other edges. An edge-to-edge toplogy does not include
intervening nodes.
</p>
</div>
<p>The “toid” of a terminal flowline can be either NA or, by convention,
0 or ““. Using 0 or an empty string is preferred within
<code>hydroloom</code> but both are handled in most cases. Further, as
long as 0 is not in the set of IDs, there is little practical
difference.</p>
<p>In <code>hydroloom</code>, edge-to-edge topology is referred to with
“id and toid” attributes.</p>
</div>
<div class="section level3">
<h3 id="representing-dendritic-network-topology-1">Representing Dendritic Network Topology<a class="anchor" aria-label="anchor" href="#representing-dendritic-network-topology-1"></a>
</h3>
<p>As discussed in the <code><a href="../articles/hydroloom.html">vignette("hydroloom")</a></code> vignette, a
hydrologic flow network can be represented as an edge to edge (e.g. edge
list) topology or an edge-node topology. In the case of dendritic
networks, an edge list can be stored as a single “toid” attribute on
each feature and nodes are redundant as there would be one and only one
node for each feature. In non-dendritic networks, an edge list can
include multiple “toid” attributes for each feature, necessitating a one
to many relationship that can be difficult to interpret. Nevertheless,
the U.S. National Hydrography Dataset uses an edge-list format in its
“flow table” and the format is capable of storing non-dendritic feature
topology.</p>
<p>Using a node topology to store a flow network, each feature flows
from one and only one node and flows to one and only one node. This one
to one relationship between features and their from and to nodes means
that the topology fits in a table with one row per feature as is common
practice in spatial feature data.</p>
<p>For this reason, the NHDPlus data model converts the NHD “flow table”
into node topology in its representation of non dendritic topology. The
downside of this approach is that it requires creation of a node
identifier. These node identifiers are a table deduplication device that
enables a one to many relationship (the flow table) to be represented as
two one to one relationships. Given this, in hydrologic flow networks,
node identifiers can be created based on an edge list and discarded when
no longer needed.</p>
<div class="row">
<div class="column">
<p><img src="hydroloom_files/figure-html/node1-1.png" width="45%" style="display: block; margin: auto;"></p>
</div>
<div class="column">
<p><img src="hydroloom_files/figure-html/node2-1.png" width="45%" style="display: block; margin: auto;"></p>
</div>
</div>
<p>In this example of an edge list topology and a node topology for the
same system, feature ‘1’ flows to two edges but only one node. We can
represent this in tabular form with a duplicated row for the divergence
downstream of ‘1’ or with the addition of node identifiers as shown in
the following tables.</p>
<div class="row">
<div class="column">
<table class="table">
<thead><tr class="header">
<th>id</th>
<th>fromnode</th>
<th>tonode</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>N1</td>
<td>N2</td>
</tr>
<tr class="even">
<td>2</td>
<td>N2</td>
<td>N3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>N3</td>
<td>N4</td>
</tr>
<tr class="even">
<td>4</td>
<td>N2</td>
<td>N4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>N4</td>
<td>N5</td>
</tr>
</tbody>
</table>
</div>
<div class="column">
<table class="table">
<thead><tr class="header">
<th>id</th>
<th>toid</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>1</td>
<td>4</td>
</tr>
<tr class="odd">
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td>3</td>
<td>5</td>
</tr>
<tr class="odd">
<td>4</td>
<td>5</td>
</tr>
<tr class="even">
<td>5</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level3">
<h3 id="network-graph-representation">Network Graph Representation<a class="anchor" aria-label="anchor" href="#network-graph-representation"></a>
</h3>
<p>The <code><a href="../reference/make_index_ids.html">make_index_ids()</a></code> <code>hydroloom</code> function
creates an adjacency matrix representation of a flow network as well as
some convenient content that are useful when traversing the graph. This
adjacency matrix is used heavily in <code>hydroloom</code> functions and
may be useful to people who want to write their own graph traversal
algorithms.</p>
<p>A companion to <code><a href="../reference/make_index_ids.html">make_index_ids()</a></code>,
<code><a href="../reference/make_fromids.html">make_fromids()</a></code> reverses the graph such that the adjacency
matrix is directed opposite the direction of the provided graph. This is
used for upstream flow network traversals.</p>
<p>In the example below we’ll add a dendritic toid and explore the
<code><a href="../reference/make_index_ids.html">make_index_ids()</a></code> output.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_toids.html">add_toids</a></span><span class="op">(</span><span class="va">hy_net</span>, return_dendritic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ind_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_index_ids.html">make_index_ids</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "to"      "lengths" "to_list"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">$</span><span class="va">to</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   1 746</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">$</span><span class="va">to_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "id"      "indid"   "toindid"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ind_id</span>, <span class="va">class</span><span class="op">)</span></span>
<span><span class="co">#&gt; $to</span></span>
<span><span class="co">#&gt; [1] "matrix" "array" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lengths</span></span>
<span><span class="co">#&gt; [1] "numeric"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $to_list</span></span>
<span><span class="co">#&gt; [1] "data.frame"</span></span></code></pre></div>
<p>Now we’ll look at the same thing but for a non dendritic set of
toids. Notice that the <code>to</code> element of <code>ind_id</code>
now has three rows. This indicates that one or more of the connections
in the matrix has three downstream neighbors. The <code>lengths</code>
element indicates how many non <code>NA</code> values are in each column
of the matrix in the <code>to</code> element.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_toids.html">add_toids</a></span><span class="op">(</span><span class="fu">st_drop_geometry</span><span class="op">(</span><span class="va">hy_net</span><span class="op">)</span>, return_dendritic <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ind_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_index_ids.html">make_index_ids</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "to"      "lengths" "to_list"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">$</span><span class="va">to</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   3 746</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">$</span><span class="va">lengths</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 84</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">$</span><span class="va">lengths</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ind_id</span><span class="op">$</span><span class="va">to_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "id"      "indid"   "toindid"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ind_id</span>, <span class="va">class</span><span class="op">)</span></span>
<span><span class="co">#&gt; $to</span></span>
<span><span class="co">#&gt; [1] "matrix" "array" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lengths</span></span>
<span><span class="co">#&gt; [1] "numeric"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $to_list</span></span>
<span><span class="co">#&gt; [1] "data.frame"</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David Blodgett.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
